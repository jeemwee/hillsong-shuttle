window.wp=window.wp||{},jQuery(document).ready(function(t){function e(t){var e,i,o,n,s,d=jQuery.ui.keyCode,a=t.keyCode,h=document.createRange(),r=x[0].selectionStart,w=x[0].selectionEnd,g=B[0].firstChild;if(!r||!w||r===w){try{h.setStart(g,r),h.setEnd(g,w+1)}catch(t){}(e=h.getBoundingClientRect()).height&&(o=(i=e.top-10)+e.height+10,n=F.adminBarHeight+F.toolsHeight+F.textTopHeight,s=F.windowHeight-F.bottomHeight,i<n&&(a===d.UP||a===d.LEFT||a===d.BACKSPACE)?window.scrollTo(window.pageXOffset,i+window.pageYOffset-n):o>s&&window.scrollTo(window.pageXOffset,o+window.pageYOffset-s))}}function i(){if(!(h&&!h.isHidden()||!h&&"tinymce"===L)){var t,e=x.height();B.width(x.width()-22),B.text(x.val()+"&nbsp;"),(t=B.height())<K&&(t=K),t!==e&&(x.height(t),o())}}function o(t){if(!E||!E.settings.visible){var e,o,n,s,d,a,r,u,z=w.scrollTop(),A="scroll"!==t,P=h&&!h.isHidden(),L=K,N=S.offset().top,j=c.width();!A&&F.windowHeight||function(){var t=w.width();(F={windowHeight:w.height(),windowWidth:t,adminBarHeight:t>600?p.outerHeight():0,toolsHeight:l.outerHeight()||0,menuBarHeight:y.outerHeight()||0,visualTopHeight:H.outerHeight()||0,textTopHeight:b.outerHeight()||0,bottomHeight:T.outerHeight()||0,statusBarHeight:v.outerHeight()||0,sideSortablesHeight:C.height()||0}).menuBarHeight<3&&(F.menuBarHeight=0)}(),P||"resize"!==t||i(),P?(e=H,o=m,a=F.visualTopHeight):(e=b,o=x,a=F.textTopHeight),d=e.parent().offset().top,r=o.offset().top,(u=o.outerHeight())>(P?K+a:K+20)+5?((!R||A)&&z>=d-F.toolsHeight-F.adminBarHeight&&z<=d-F.toolsHeight-F.adminBarHeight+u-L?(R=!0,l.css({position:"fixed",top:F.adminBarHeight,width:j}),P&&y.length&&y.css({position:"fixed",top:F.adminBarHeight+F.toolsHeight,width:j-2-(P?0:e.outerWidth()-e.width())}),e.css({position:"fixed",top:F.adminBarHeight+F.toolsHeight+F.menuBarHeight,width:j-2-(P?0:e.outerWidth()-e.width())})):(R||A)&&(z<=d-F.toolsHeight-F.adminBarHeight?(R=!1,l.css({position:"absolute",top:0,width:j}),P&&y.length&&y.css({position:"absolute",top:0,width:j-2}),e.css({position:"absolute",top:F.menuBarHeight,width:j-2-(P?0:e.outerWidth()-e.width())})):z>=d-F.toolsHeight-F.adminBarHeight+u-L&&(R=!1,l.css({position:"absolute",top:u-L,width:j}),P&&y.length&&y.css({position:"absolute",top:u-L,width:j-2}),e.css({position:"absolute",top:u-L+F.menuBarHeight,width:j-2-(P?0:e.outerWidth()-e.width())}))),(!Y||A)&&z+F.windowHeight<=r+u+F.bottomHeight+F.statusBarHeight+1?(Y=!0,v.css({position:"fixed",bottom:F.bottomHeight,width:j-2}),T.css({position:"fixed",bottom:0,width:j})):(Y||A)&&z+F.windowHeight>r+u+F.bottomHeight+F.statusBarHeight-1&&(Y=!1,v.add(T).attr("style",""))):A&&(l.css({position:"absolute",top:0,width:j}),P&&y.length&&y.css({position:"absolute",top:0,width:j-2}),e.css({position:"absolute",top:F.menuBarHeight,width:j-2-(P?0:e.outerWidth()-e.width())}),v.add(T).attr("style","")),O.width()<300&&F.windowWidth>600&&g.height()>C.height()+N+120&&F.windowHeight<u?(F.sideSortablesHeight+U+X>F.windowHeight||_||W?z+U<=N?(C.attr("style",""),_=W=!1):z>k?_?(_=!1,n=C.offset().top-F.adminBarHeight,(s=f.offset().top)<n+F.sideSortablesHeight+X&&(n=s-F.sideSortablesHeight-12),C.css({position:"absolute",top:n,bottom:""})):!W&&F.sideSortablesHeight+C.offset().top+X<z+F.windowHeight&&(W=!0,C.css({position:"fixed",top:"auto",bottom:X})):z<k&&(W?(W=!1,n=C.offset().top-X,(s=f.offset().top)<n+F.sideSortablesHeight+X&&(n=s-F.sideSortablesHeight-12),C.css({position:"absolute",top:n,bottom:""})):!_&&C.offset().top>=z+U&&(_=!0,C.css({position:"fixed",top:U,bottom:""}))):(z>=N-U?C.css({position:"fixed",top:U}):C.attr("style",""),_=W=!1),k=z):(C.attr("style",""),_=W=!1),A&&(c.css({paddingTop:F.toolsHeight}),P?m.css({paddingTop:F.visualTopHeight+F.menuBarHeight}):(x.css({marginTop:F.textTopHeight}),B.width(j-20-2)))}}function n(){i(),o()}function s(t){for(var e=1;e<6;e++)setTimeout(t,500*e)}function d(){window.pageYOffset&&window.pageYOffset>P&&window.scrollTo(window.pageXOffset,0),u.addClass("wp-editor-expand"),w.on("scroll.editor-expand resize.editor-expand",function(t){o(t.type),clearTimeout(r),r=setTimeout(o,100)}),g.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",o).on("postbox-toggled.editor-expand",function(){!_&&!W&&window.pageYOffset>U&&(W=!0,window.scrollBy(0,-1),o(),window.scrollBy(0,1)),o()}),x.on("focus.editor-expand input.editor-expand propertychange.editor-expand",i),x.on("keyup.editor-expand",e),z(),E&&E.pubsub.subscribe("hidden",n),h&&(h.settings.wp_autoresize_on=!0,h.execCommand("wpAutoResizeOn"),h.isHidden()||h.execCommand("wpAutoResize")),h&&!h.isHidden()||i(),o()}function a(){var e=window.getUserSetting("ed_size");window.pageYOffset&&window.pageYOffset>P&&window.scrollTo(window.pageXOffset,0),u.removeClass("wp-editor-expand"),w.off(".editor-expand"),g.off(".editor-expand"),x.off(".editor-expand"),A(),E&&E.pubsub.unsubscribe("hidden",n),t.each([H,b,l,y,T,v,c,m,x,C],function(t,e){e&&e.attr("style","")}),R=Y=_=W=!1,h&&(h.settings.wp_autoresize_on=!1,h.execCommand("wpAutoResizeOff"),h.isHidden()||(x.hide(),e&&h.theme.resizeTo(null,e))),e&&x.height(e)}var h,r,w=t(window),g=t(document),p=t("#wpadminbar"),f=t("#wpfooter"),u=t("#postdivrich"),c=t("#wp-content-wrap"),l=t("#wp-content-editor-tools"),H=t(),m=t(),b=t("#ed_toolbar"),x=t("#content"),B=t('<div id="content-textarea-clone"></div>'),T=t("#post-status-info"),y=t(),v=t(),C=t("#side-sortables"),O=t("#postbox-container-1"),S=t("#post-body"),E=window.wp.editor&&window.wp.editor.fullscreen,z=function(){},A=function(){},R=!1,Y=!1,_=!1,W=!1,k=0,P=130,U=56,X=20,K=300,L=window.getUserSetting("editor"),F={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0};B.insertAfter(x),B.css({"font-family":x.css("font-family"),"font-size":x.css("font-size"),"line-height":x.css("line-height"),"white-space":"pre-wrap","word-wrap":"break-word"}),g.on("tinymce-editor-init.editor-expand",function(t,e){function n(t){var i,o,n,s,d=tinymce.util.VK,a=t.keyCode,h=function(){var t,i,o=e.selection.getNode();return!!(i=e.plugins.wpview&&(t=e.plugins.wpview.getView(o))?t.getBoundingClientRect():o.getBoundingClientRect()).height&&i}();h&&(a<=47&&a!==d.SPACEBAR&&a!==d.ENTER&&a!==d.DELETE&&a!==d.BACKSPACE&&a!==d.UP&&a!==d.LEFT&&a!==d.DOWN&&a!==d.UP||a>=91&&a<=93||a>=112&&a<=123||144===a||145===a||(o=(i=h.top+e.iframeElement.getBoundingClientRect().top)+h.height,i-=10,o+=10,n=F.adminBarHeight+F.toolsHeight+F.menuBarHeight+F.visualTopHeight,(s=F.windowHeight-F.bottomHeight-F.statusBarHeight)-n<h.height||(i<n&&(a===d.UP||a===d.LEFT||a===d.BACKSPACE)?window.scrollTo(window.pageXOffset,i+window.pageYOffset-n):o>s&&window.scrollTo(window.pageXOffset,o+window.pageYOffset-s))))}function d(){setTimeout(function(){e.execCommand("wpAutoResize"),o()},300)}function a(){setTimeout(function(){var t=c.offset().top;window.pageYOffset>t&&window.scrollTo(window.pageXOffset,t-F.adminBarHeight),i(),o()},100),o()}"content"===e.id&&(h=e,e.settings.autoresize_min_height=K,H=c.find(".mce-toolbar-grp"),m=c.find(".mce-edit-area"),v=c.find(".mce-statusbar"),y=c.find(".mce-menubar"),z=function(){e.on("keyup",n),e.on("show",d),e.on("hide",a),e.on("setcontent wp-autoresize wp-toolbar-toggle",o)},A=function(){e.off("keyup",n),e.off("show",d),e.off("hide",a),e.off("setcontent wp-autoresize wp-toolbar-toggle",o)},u.hasClass("wp-editor-expand")&&(z(),s(o)))}),u.hasClass("wp-editor-expand")&&(d(),c.hasClass("html-active")&&s(function(){o(),i()})),t("#adv-settings .editor-expand").show(),t("#editor-expand-toggle").on("change.editor-expand",function(){t(this).prop("checked")?(d(),window.setUserSetting("editor_expand","on")):(a(),window.setUserSetting("editor_expand","off"))}),window.editorExpand={on:d,off:a}});