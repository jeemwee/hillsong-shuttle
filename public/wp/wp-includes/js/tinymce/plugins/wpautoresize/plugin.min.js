tinymce.PluginManager.add("wpautoresize",function(e){function t(e){return parseInt(e,10)||0}function o(n){var r,u,l,d,g,m,h,f,c,y,p,_,w=tinymce.DOM;s&&(u=e.getDoc())&&(n=n||{},l=u.body,d=u.documentElement,g=i.autoresize_min_height,!l||n&&"setcontent"===n.type&&n.initial||e.plugins.fullscreen&&e.plugins.fullscreen.isFullscreen()?l&&d&&(l.style.overflowY="auto",d.style.overflowY="auto"):(h=e.dom.getStyle(l,"margin-top",!0),f=e.dom.getStyle(l,"margin-bottom",!0),c=e.dom.getStyle(l,"padding-top",!0),y=e.dom.getStyle(l,"padding-bottom",!0),p=e.dom.getStyle(l,"border-top-width",!0),_=e.dom.getStyle(l,"border-bottom-width",!0),(m=l.offsetHeight+t(h)+t(f)+t(c)+t(y)+t(p)+t(_))&&m<d.offsetHeight&&(m=d.offsetHeight),(isNaN(m)||m<=0)&&(m=tinymce.Env.ie?l.scrollHeight:tinymce.Env.webkit&&0===l.clientHeight?0:l.offsetHeight),m>i.autoresize_min_height&&(g=m),i.autoresize_max_height&&m>i.autoresize_max_height?(g=i.autoresize_max_height,l.style.overflowY="auto",d.style.overflowY="auto"):(l.style.overflowY="hidden",d.style.overflowY="hidden",l.scrollTop=0),g!==a&&(r=g-a,w.setStyle(e.iframeElement,"height",g+"px"),a=g,tinymce.isWebKit&&r<0&&o(n),e.fire("wp-autoresize",{height:g}))))}function n(e,t,i){setTimeout(function(){o(),e--?n(e,t,i):i&&i()},t)}var i=e.settings,a=300,s=!1;e.settings.inline||(i.autoresize_min_height=parseInt(e.getParam("autoresize_min_height",e.getElement().offsetHeight),10),i.autoresize_max_height=parseInt(e.getParam("autoresize_max_height",0),10),i.wp_autoresize_on&&(s=!0,e.on("init",function(){e.dom.addClass(e.getBody(),"wp-autoresize")}),e.on("nodechange keyup FullscreenStateChanged",o),e.on("setcontent",function(){n(3,100)}),e.getParam("autoresize_on_init",!0)&&e.on("init",function(){n(10,200,function(){n(5,1e3)})})),e.on("show",function(){a=0}),e.addCommand("wpAutoResize",o),e.addCommand("wpAutoResizeOn",function(){e.dom.hasClass(e.getBody(),"wp-autoresize")||(s=!0,e.dom.addClass(e.getBody(),"wp-autoresize"),e.on("nodechange setcontent keyup FullscreenStateChanged",o),o())}),e.addCommand("wpAutoResizeOff",function(){var t;i.wp_autoresize_on||(s=!1,t=e.getDoc(),e.dom.removeClass(e.getBody(),"wp-autoresize"),e.off("nodechange setcontent keyup FullscreenStateChanged",o),t.body.style.overflowY="auto",t.documentElement.style.overflowY="auto",a=0)}))});