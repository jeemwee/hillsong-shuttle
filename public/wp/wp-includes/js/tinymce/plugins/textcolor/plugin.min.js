tinymce.PluginManager.add("textcolor",function(t){function e(){function e(t,e){var o="transparent"==t;return'<td class="mce-grid-cell'+(o?" mce-colorbtn-trans":"")+'"><div id="'+u+"-"+g+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+tinymce.translate(e)+'">'+(o?"&#215;":"")+"</div></td>"}var o,r,l,c,i,s,d,u=this._id,g=0;for((o=function(){var e,o,r=[];for(o=t.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],e=0;e<o.length;e+=2)r.push({text:o[e+1],color:"#"+o[e]});return r}()).push({text:tinymce.translate("No color"),color:"transparent"}),l='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',c=o.length-1,s=0;s<n;s++){for(l+="<tr>",i=0;i<a;i++)l+=(d=s*a+i)>c?"<td></td>":e((r=o[d]).color,r.text);l+="</tr>"}if(t.settings.color_picker_callback){for(l+='<tr><td colspan="'+a+'" class="mce-custom-color-btn"><div id="'+u+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+u+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>",l+="<tr>",i=0;i<a;i++)l+=e("","Custom color");l+="</tr>"}return l+="</tbody></table>"}function o(e,o){t.focus(),t.formatter.apply(e,{value:o}),t.nodeChanged()}function r(e){function r(t){c.hidePanel(),c.color(t),o(c.settings.format,t)}function l(t,e){t.style.background=e,t.setAttribute("data-mce-color",e)}var n,c=this.parent();if(tinymce.DOM.getParent(e.target,".mce-custom-color-btn")&&(c.hidePanel(),t.settings.color_picker_callback.call(t,function(t){var e,o,n,i=c.panel.getEl().getElementsByTagName("table")[0];for(e=tinymce.map(i.rows[i.rows.length-1].childNodes,function(t){return t.firstChild}),n=0;n<e.length&&(o=e[n]).getAttribute("data-mce-color");n++);if(n==a)for(n=0;n<a-1;n++)l(e[n],e[n+1].getAttribute("data-mce-color"));l(o,t),r(t)},function(e){var o;return t.dom.getParents(t.selection.getStart(),function(t){var r;(r=t.style["forecolor"==e?"color":"background-color"])&&(o=r)}),o}(c.settings.format))),n=e.target.getAttribute("data-mce-color")){if(this.lastId&&document.getElementById(this.lastId).setAttribute("aria-selected",!1),e.target.setAttribute("aria-selected",!0),this.lastId=e.target.id,"transparent"==n)return function(e){t.focus(),t.formatter.remove(e,{value:null},null,!0),t.nodeChanged()}(c.settings.format),void c.hidePanel();r(n)}else null!==n&&c.hidePanel()}function l(){this._color&&o(this.settings.format,this._color)}var a,n;n=t.settings.textcolor_rows||5,a=t.settings.textcolor_cols||8,t.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:e,onclick:r},onclick:l}),t.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:e,onclick:r},onclick:l})});