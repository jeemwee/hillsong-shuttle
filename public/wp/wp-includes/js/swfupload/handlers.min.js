function fileDialogStart(){jQuery("#media-upload-error").empty()}function fileQueued(e){jQuery(".media-blank").remove(),1==jQuery("form.type-form #media-items").children().length&&jQuery(".hidden","#media-items").length>0&&(jQuery(".describe-toggle-on").show(),jQuery(".describe-toggle-off").hide(),jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")),jQuery('<div class="media-item">').attr("id","media-item-"+e.id).addClass("child-of-"+post_id).append('<div class="progress"><div class="bar"></div></div>',jQuery('<div class="filename original"><span class="percent"></span>').text(" "+e.name)).appendTo(jQuery("#media-items")),jQuery(".progress","#media-item-"+e.id).show(),jQuery("#insert-gallery").prop("disabled",!0),jQuery("#cancel-upload").prop("disabled",!1)}function uploadStart(e){try{void 0!==topWin.tb_remove&&topWin.jQuery("#TB_overlay").unbind("click",topWin.tb_remove)}catch(e){}return!0}function uploadProgress(e,r,i){var t=jQuery("#media-items").width()-2,a=jQuery("#media-item-"+e.id);jQuery(".bar",a).width(t*r/i),jQuery(".percent",a).html(Math.ceil(r/i*100)+"%"),r==i&&jQuery(".bar",a).html('<strong class="crunching">'+swfuploadL10n.crunching+"</strong>")}function prepareMediaItem(e,r){var i="undefined"==typeof shortform?1:2,t=jQuery("#media-item-"+e.id);jQuery(".bar",t).remove(),jQuery(".progress",t).hide();try{void 0!==topWin.tb_remove&&topWin.jQuery("#TB_overlay").click(topWin.tb_remove)}catch(e){}isNaN(r)||!r?(t.append(r),prepareMediaItemInit(e)):t.load("async-upload.php",{attachment_id:r,fetch:i},function(){prepareMediaItemInit(e),updateMediaForm()})}function prepareMediaItemInit(e){var r=jQuery("#media-item-"+e.id);jQuery(".thumbnail",r).clone().attr("class","pinkynail toggle").prependTo(r),jQuery(".filename.original",r).replaceWith(jQuery(".filename.new",r)),jQuery("a.toggle",r).click(function(){return jQuery(this).siblings(".slidetoggle").slideToggle(350,function(){var e,r=jQuery(window).height(),i=jQuery(this).offset().top,t=jQuery(this).height();r&&i&&t&&((e=i+t)>r&&t+48<r?window.scrollBy(0,e-r+13):e>r&&window.scrollTo(0,i-36))}),jQuery(this).siblings(".toggle").andSelf().toggle(),jQuery(this).siblings("a.toggle").focus(),!1}),jQuery("a.delete",r).click(function(){return jQuery.ajax({url:ajaxurl,type:"post",success:deleteSuccess,error:deleteError,id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"trash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")}}),!1}),jQuery("a.undo",r).click(function(){return jQuery.ajax({url:ajaxurl,type:"post",id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"untrash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")},success:function(r,i){var t=jQuery("#media-item-"+e.id);(type=jQuery("#type-of-"+e.id).val())&&jQuery("#"+type+"-counter").text(jQuery("#"+type+"-counter").text()-0+1),t.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(jQuery("#attachments-count").text()-0+1),jQuery(".filename .trashnotice",t).remove(),jQuery(".filename .title",t).css("font-weight","normal"),jQuery("a.undo",t).addClass("hidden"),jQuery("a.describe-toggle-on, .menu_order_input",t).show(),t.css({backgroundColor:"#ceb"}).animate({backgroundColor:"#fff"},{queue:!1,duration:500,complete:function(){jQuery(this).css({backgroundColor:""})}}).removeClass("undo")}}),!1}),jQuery("#media-item-"+e.id+".startopen").removeClass("startopen").slideToggle(500).siblings(".toggle").toggle()}function itemAjaxError(e,r){var i=jQuery("#media-item-"+e),t=jQuery(".filename",i).text();i.html('<div class="error-div"><a class="dismiss" href="#">'+swfuploadL10n.dismiss+"</a><strong>"+swfuploadL10n.error_uploading.replace("%s",t)+"</strong><br />"+r+"</div>"),i.find("a.dismiss").click(function(){jQuery(this).parents(".media-item").slideUp(200,function(){jQuery(this).remove()})})}function deleteSuccess(e,r){if("-1"==e)return itemAjaxError(this.id,"You do not have permission. Has your session expired?");if("0"==e)return itemAjaxError(this.id,"Could not be deleted. Has it been deleted already?");var i=this.id,t=jQuery("#media-item-"+i);(type=jQuery("#type-of-"+i).val())&&jQuery("#"+type+"-counter").text(jQuery("#"+type+"-counter").text()-1),t.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(jQuery("#attachments-count").text()-1),1==jQuery("form.type-form #media-items").children().length&&jQuery(".hidden","#media-items").length>0&&(jQuery(".toggle").toggle(),jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")),jQuery(".toggle",t).toggle(),jQuery(".slidetoggle",t).slideUp(200).siblings().removeClass("hidden"),t.css({backgroundColor:"#faa"}).animate({backgroundColor:"#f4f4f4"},{queue:!1,duration:500}).addClass("undo"),jQuery(".filename:empty",t).remove(),jQuery(".filename .title",t).css("font-weight","bold"),jQuery(".filename",t).append('<span class="trashnotice"> '+swfuploadL10n.deleted+" </span>").siblings("a.toggle").hide(),jQuery(".filename",t).append(jQuery("a.undo",t).removeClass("hidden")),jQuery(".menu_order_input",t).hide()}function deleteError(e,r,i){}function updateMediaForm(){var e=jQuery("form.type-form #media-items").children(),r=jQuery("#media-items").children();1==e.length&&jQuery(".slidetoggle",e).slideDown(500).siblings().addClass("hidden").filter(".toggle").toggle(),r.not(".media-blank").length>0?jQuery(".savebutton").show():jQuery(".savebutton").hide(),r.length>1?jQuery(".insert-gallery").show():jQuery(".insert-gallery").hide()}function uploadSuccess(e,r){r.match("media-upload-error")?jQuery("#media-item-"+e.id).html(r):(prepareMediaItem(e,r),updateMediaForm(),jQuery("#media-item-"+e.id).hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(1*jQuery("#attachments-count").text()+1))}function uploadComplete(e){0==swfu.getStats().files_queued&&(jQuery("#cancel-upload").prop("disabled",!0),jQuery("#insert-gallery").prop("disabled",!1))}function wpQueueError(e){jQuery("#media-upload-error").show().text(e)}function wpFileError(e,r){var i=jQuery("#media-item-"+e.id),t=jQuery(".filename",i).text();i.html('<div class="error-div"><a class="dismiss" href="#">'+swfuploadL10n.dismiss+"</a><strong>"+swfuploadL10n.error_uploading.replace("%s",t)+"</strong><br />"+r+"</div>"),i.find("a.dismiss").click(function(){jQuery(this).parents(".media-item").slideUp(200,function(){jQuery(this).remove()})})}function fileQueueError(e,r,i){r==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED?wpQueueError(swfuploadL10n.queue_limit_exceeded):r==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT?(fileQueued(e),wpFileError(e,swfuploadL10n.file_exceeds_size_limit)):r==SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE?(fileQueued(e),wpFileError(e,swfuploadL10n.zero_byte_file)):r==SWFUpload.QUEUE_ERROR.INVALID_FILETYPE?(fileQueued(e),wpFileError(e,swfuploadL10n.invalid_filetype)):wpQueueError(swfuploadL10n.default_error)}function fileDialogComplete(e){try{e>0&&this.startUpload()}catch(e){this.debug(e)}}function switchUploader(e){var r=document.getElementById(swfu.customSettings.swfupload_element_id),i=document.getElementById(swfu.customSettings.degraded_element_id);e?(r.style.display="block",i.style.display="none"):(r.style.display="none",i.style.display="block")}function swfuploadPreLoad(){switchUploader(uploaderMode?0:1)}function swfuploadLoadFailed(){switchUploader(0),jQuery(".upload-html-bypass").hide()}function uploadError(e,r,i){switch(r){case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:wpFileError(e,swfuploadL10n.missing_upload_url);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:wpFileError(e,swfuploadL10n.upload_limit_exceeded);break;case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:wpQueueError(swfuploadL10n.http_error);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:wpQueueError(swfuploadL10n.upload_failed);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:wpQueueError(swfuploadL10n.io_error);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:wpQueueError(swfuploadL10n.security_error);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:jQuery("#media-item-"+e.id).remove();break;default:wpFileError(e,swfuploadL10n.default_error)}}function cancelUpload(){swfu.cancelQueue()}var topWin=window.dialogArguments||opener||parent||top;jQuery(document).ready(function(e){e('input[type="radio"]',"#media-items").live("click",function(){var r=e(this).closest("tr");e(r).hasClass("align")?setUserSetting("align",e(this).val()):e(r).hasClass("image-size")&&setUserSetting("imgsize",e(this).val())}),e("button.button","#media-items").live("click",function(){var r=this.className||"";(r=r.match(/url([^ '"]+)/))&&r[1]&&(setUserSetting("urlbutton",r[1]),e(this).siblings(".urlfield").val(e(this).attr("title")))})});