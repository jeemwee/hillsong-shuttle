!function($){$.scheduler=function(){this.bucket={}},$.scheduler.prototype={schedule:function(){function _isfn(t){return!!t&&"string"!=typeof t&&void 0===t[0]&&RegExp("function","i").test(t+"")}var ctx={id:null,time:1e3,repeat:!1,protect:!1,obj:null,func:function(){},args:[]},i=0,override=!1;if("object"==typeof arguments[i]&&arguments.length>1&&(override=!0,i++),"object"==typeof arguments[i]){for(var option in arguments[i])void 0!==ctx[option]&&(ctx[option]=arguments[i][option]);i++}for(("number"==typeof arguments[i]||"string"==typeof arguments[i]&&arguments[i].match(RegExp("^[0-9]+[smhdw]$")))&&(ctx.time=arguments[i++]),"boolean"==typeof arguments[i]&&(ctx.repeat=arguments[i++]),"boolean"==typeof arguments[i]&&(ctx.protect=arguments[i++]),"object"==typeof arguments[i]&&"string"==typeof arguments[i+1]&&_isfn(arguments[i][arguments[i+1]])?(ctx.obj=arguments[i++],ctx.func=arguments[i++]):void 0===arguments[i]||!_isfn(arguments[i])&&"string"!=typeof arguments[i]||(ctx.func=arguments[i++]);void 0!==arguments[i];)ctx.args.push(arguments[i++]);if(override){if("object"==typeof arguments[1])for(var option in arguments[0])void 0!==ctx[option]&&void 0===arguments[1][option]&&(ctx[option]=arguments[0][option]);else for(var option in arguments[0])void 0!==ctx[option]&&(ctx[option]=arguments[0][option]);i++}ctx._scheduler=this,ctx._handle=null;var match=String(ctx.time).match(RegExp("^([0-9]+)([smhdw])$"));return match&&"undefined"!=match[0]&&"undefined"!=match[1]&&(ctx.time=String(parseInt(match[1])*{s:1e3,m:6e4,h:36e5,d:864e5,w:6048e5}[match[2]])),null==ctx.id&&(ctx.id=String(ctx.repeat)+":"+String(ctx.protect)+":"+String(ctx.time)+":"+String(ctx.obj)+":"+String(ctx.func)+":"+String(ctx.args)),ctx.protect&&void 0!==this.bucket[ctx.id]?this.bucket[ctx.id]:(_isfn(ctx.func)||(null!=ctx.obj&&"object"==typeof ctx.obj&&"string"==typeof ctx.func&&_isfn(ctx.obj[ctx.func])?ctx.func=ctx.obj[ctx.func]:ctx.func=eval("function () { "+ctx.func+" }")),ctx._handle=this._schedule(ctx),this.bucket[ctx.id]=ctx,ctx)},reschedule:function(t){return"string"==typeof t&&(t=this.bucket[t]),t._handle=this._schedule(t),t},_schedule:function(t){return setTimeout(function(){var e=null!=t.obj?t.obj:t;t.func.apply(e,t.args),void 0!==t._scheduler.bucket[t.id]&&t.repeat?t._scheduler._schedule(t):delete t._scheduler.bucket[t.id]},t.time)},cancel:function(t){"string"==typeof t&&(t=this.bucket[t]),"object"==typeof t&&(clearTimeout(t._handle),delete this.bucket[t.id])}},$.extend({scheduler$:new $.scheduler,schedule:function(){return $.scheduler$.schedule.apply($.scheduler$,arguments)},reschedule:function(){return $.scheduler$.reschedule.apply($.scheduler$,arguments)},cancel:function(){return $.scheduler$.cancel.apply($.scheduler$,arguments)}}),$.fn.extend({schedule:function(){for(var t=[{}],e=0;e<arguments.length;e++)t.push(arguments[e]);return this.each(function(){return t[0]={id:this,obj:this},$.schedule.apply($,t)})}})}(jQuery);