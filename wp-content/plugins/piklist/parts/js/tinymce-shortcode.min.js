!function(t){function n(n,e){var o=t(n).data("wpview-type");return!0===piklist.shortcodes[o].inline?window.decodeURIComponent(e):"<p>"+window.decodeURIComponent(e)+"</p>"}function e(n){t("span[data-wpview-text], p[data-wpview-marker]",n).each(function(t,n){n.innerHTML="."})}tinymce.create("tinymce.plugins.PiklistShortcodePlugin",{init:function(o,i){o.on("BeforeSetContent",function(t){t.content&&(t.content=wp.mce.views.setMarkers(t.content))}),o.on("PostProcess",function(t){t.content&&(t.content=t.content.replace(/<span [^>]*?data-wpview-text="([^"]+)"[^>]*>[\s\S]*?<\/span>/g,n))}),o.on("BeforeAddUndo",function(t){t.level.content&&(t.level.content=function(t){return t.replace(/<span[^>]+data-wpview-text="([^"]+)"[^>]*>(?:[\s\S]+?wpview-selection-after[^>]+>[^<>]*<\/p>\s*|\.)<\/span>/g,n)}(t.level.content))}),o.on("PreProcess",function(t){e(t.node)},!0),o.on("hide",function(){wp.mce.views.unbind(),e()}),t.each(piklist.shortcodes,function(n,e){e.editor&&o.addButton("shortcode-"+e.shortcode,{title:e.name,icon:"dashicon dashicons "+e.icon+" piklist-shortcode-button",role:e.shortcode,onclick:function(n){var e=t(n.target).parents(".mce-btn:eq(0)");e.hasClass("piklist-shortcode-button")||e.addClass("piklist-shortcode-button").find(".piklist-shortcode-button:eq(0)").removeClass("piklist-shortcode-button")}})})},getInfo:function(){return{longname:"Piklist Shortcode Plugin",author:"Piklist",authorurl:"https://piklist.com",infourl:"https://piklist.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("piklist_shortcode",tinymce.plugins.PiklistShortcodePlugin),void 0!==wp.shortcode&&(wp.shortcode.next=function(t,n,e){var o,i,c=wp.shortcode.regexp(t);if(c.lastIndex=e||0,o=c.exec(n)){var s,r,d,a,l=n.substr(n.indexOf("["+o[2]+o[3])),p=l.match(/\[\/([^\]]+)]/g);if(p)for(var u=0;u<p.length;u++)if(s=new RegExp("\\[(\\[?)("+p[u].replace(/[\[\/\]']+/g,"")+")","g"),r=l.match(s),d=new RegExp("\\"+p[u],"g"),a=l.match(d),r&&!a||!r&&a||r&&a&&r.length<a.length)return;return"["===o[1]&&"]"===o[7]?wp.shortcode.next(t,n,c.lastIndex):(i={index:o.index,content:o[0],shortcode:wp.shortcode.fromMatch(o)},o[1]&&(i.content=i.content.slice(1),i.index++),o[7]&&(i.content=i.content.slice(0,-1)),i)}})}(jQuery);