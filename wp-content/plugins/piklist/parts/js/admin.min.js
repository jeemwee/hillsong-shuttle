!function(t,i,e,s){"use strict";t(e).ready(function(){t("body").wptabs(),a.init()});var a={init:function(){a.body_class(),a.meta_boxes(),a.post_name(),a.post_submit_meta_box(),a.thickbox(),a.user_forms(),a.tag_forms(),a.empty_elements(),a.list_tables(),a.widgets(),a.customizer(),a.shortcodes(),a.notices(),a.pointers(),a.add_ons()},body_class:function(){i.location!=i.parent.location&&t("body").addClass("piklist-in-iframe")},notices:function(){t(e).on("click",".notice.is-dismissible > .notice-dismiss",function(i){t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"piklist_notice",id:t(this).parent().attr("id")}})})},pointers:function(){t.each(piklist.pointers,function(i){var e=this.pointer_id,s=t.extend(this.options,{close:function(){t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"dismiss-wp-pointer",pointer:e}})}});t(this.target).pointer(s).pointer("open")})},add_ons:function(){t(".piklist-field-add-on-button").length>0&&t(".piklist-field-add-on-button").click(function(i){i.preventDefault(),t(this).hasClass("button-primary")?(t(this).removeClass("button-primary").addClass("button").text("Disable").prev(":checkbox").attr("checked",!0),t(this).next("a").show()):(t(this).removeClass("button").addClass("button-primary").text("Activate").prev(":checkbox").attr("checked",!1),t(this).next("a").hide())})},empty_elements:function(){t("#post-body-content").each(function(){""==t.trim(t(this).html())&&t(this).html("")})},tag_forms:function(){t("body.wp-admin.edit-tags-php form#addtag :submit").on("click",function(e){t("body.wp-admin.edit-tags-php form#addtag :input#tag-name").on("change",function(t){i.location.href=i.location.href})})},user_forms:function(){"WebkitAppearance"in e.documentElement.style&&setTimeout(function(){t("input:-webkit-autofill").each(function(){var i=t(this).attr("name");t(this).after(this.outerHTML).remove(),t("input[name="+i+"]").val("")})},250)},thickbox:function(){t(e).on("click","body.piklist-in-iframe .piklist-upload-file-button, body.piklist-in-iframe .wp-media-buttons button",function(){t("#TB_iframeContent",i.parent.document).css({position:"absolute",top:0,left:0,height:t("#TB_window",i.parent.document).height()}),setTimeout(function(){(void 0!==wp.media.frames.file_frame?wp.media.frames.file_frame:wp.media.frame).on("close",function(){t("#TB_iframeContent",i.parent.document).css({position:"relative",top:"auto",left:"auto",height:t("#TB_window",i.parent.document).height()-t("#TB_title",i.parent.document).height()})})},100)}),t(e).on("click",".piklist-list-table-export-button",function(){setTimeout(function(){t("#TB_window").css({marginLeft:"-"+parseInt(435,10)+"px",width:"870px",height:"800px",marginTop:"-"+parseInt(400,10)+"px"}),t("#TB_ajaxContent").css({height:"755px"})},100)})},meta_boxes:function(){t(".piklist-meta-box-collapse:not(.piklist-meta-box-lock)").addClass("closed"),t(".piklist-meta-box-lock").addClass("stuffbox").css("box-shadow","none").find(".handlediv").hide().next("h3.hndle").removeClass("hndle").css("cursor","default"),t(".piklist-meta-box-lock").each(function(){t(this).hasClass("hide-if-js")||t(this).show(),t(this).find("h2.hndle").removeClass("hndle").addClass("piklist-meta-box-hndle")}),t(".piklist-meta-box > .inside").each(function(){t(this).find(" > *:first-child").hasClass("piklist-field-container")&&t(this).css({"margin-top":"0"})})},post_name:function(){var i=t("body.wp-admin.post-php form#post:first");if(i.length>0){i.find(":input#post_name").length<=0&&i.append(t('<input type="hidden" name="post_name" id="post_name">'))}},post_submit_meta_box:function(){if(void 0!==piklist.post&&void 0!==piklist.post_statuses&&t("div#submitdiv.postbox").length>0){var e,s=t("select#post_status"),a=!1,o=!1;t(":input#original_post_status").val(piklist.post.post_status),s.children().each(function(){t(this).val();void 0!==piklist.post_statuses&&t(this).remove()});for(var n in piklist.post_statuses)s.append('<option value="'+n+'" '+(n==piklist.post.post_status?'selected="selected"':"")+">"+piklist.post_statuses[n].label+"</option>"),"publish"==n?o=!0:"draft"==n&&(a=!0),e||(e=piklist.post_statuses[n]);t("span#post-status-display").text("auto-draft"!=piklist.post.post_status&&void 0!==piklist.post_statuses[piklist.post.post_status]?piklist.post_statuses[piklist.post.post_status].label:e.label),o||(t("div#submitdiv.postbox > h3 > span").text()==i.postL10n.publish&&t("div#submitdiv.postbox > h3 > span").text("Update"),t(":input#publish").attr("name","save").val("Update"),i.postL10n.publish="Update"),a||t(":input#save-post").remove(),t(".save-post-status, .cancel-post-status","#post-status-select").on("click",function(i){i.preventDefault();var e=s.val(),a=s.find("> option:selected").val();"draft"!=e&&t("#hidden_post_status, #original_publish").val(a)}),t("#publish","#major-publishing-actions").on("click",function(){"none"!=t("#post-status-select").css("display")&&t(".save-post-status","#post-status-select").trigger("click"),"none"!=t("#post-visibility-select").css("display")&&t(".save-post-visibility","#post-visibility-select").trigger("click")})}},shortcodes:function(){if(t.each(piklist.shortcodes,function(t,i){if(wp.mce.views){var e=void 0!==i.shortcode?i.shortcode:i;wp.mce.views.register(e,a.shortcode(e))}}),t(i).on("resize",function(){var e=t("#TB_iframeContent");if(e.length>0&&e.attr("src").indexOf("page=shortcode_editor")){var s=Math.round(t(i).width()-60),a=Math.round(t(i).height()-60);t("#TB_window").css({width:s,height:a,top:"50%","margin-left":-s/2,"margin-top":-a/2}).find("iframe").css({width:"100%",height:a-t("#TB_title").height()})}}),t(e).on("click",".piklist-shortcode-button",function(e){e.preventDefault();var s=t(this).prop("title"),a=void 0!==parent.tinymce.activeEditor&&parent.tinymce.activeEditor,o=i.location!=i.parent.location,n=a&&!o?a.selection.getContent({format:"html"}):null,r=location.href,p=r.substr(0,r.indexOf("/wp-"))+"/wp-admin/admin.php",d={page:"shortcode_editor"};t(this).hasClass("mce-btn")?(s=t(this).attr("aria-label"),d[piklist.prefix+"shortcode_data[name]"]=t(this).attr("role"),d[piklist.prefix+"shortcode_data[action]"]="insert"):t(this).hasClass("mce-ico")?(s=t(this).parents(".mce-btn").attr("aria-label"),d[piklist.prefix+"shortcode_data[name]"]=t(this).parents(".mce-btn").attr("role"),d[piklist.prefix+"shortcode_data[action]"]="insert"):t(this).data("piklist-shortcode")&&(d[piklist.prefix+"shortcode_data[name]"]=t(this).data("piklist-shortcode"),d[piklist.prefix+"shortcode_data[action]"]="insert"),"undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1&&(d[piklist.prefix+"post[ID]"]=t("#post_ID").val()),d[piklist.prefix+"[admin_hide_ui]"]="true",n&&!o&&(d[piklist.prefix+"shortcode_data[content]"]=n),d.TB_iframe="true",tb_show(s,p+"?"+t.param(d)),t(i,parent).trigger("resize")}),t(e).on("beforePreWpautop",function(t){if(!wp.autosave){var i=tinyMCE.activeEditor;i.selection.select(i.getBody(),!0),i.selection.collapse(!0)}}),t("body.admin_page_shortcode_editor").length>0)if(piklist.validate_check){for(var s,o=t(':input[name^="'+piklist.prefix+'shortcode_data["]').serializeArray(),n={attrs:{},type:"single"},r=null,p="",d="",l=0;l<o.length;l++)"content"==(r=o[l].name.replace(piklist.prefix+"shortcode_data[","").replace(/[\[\]']+/g,""))?(n.content=parent.switchEditors._wp_Nop(o[l].value).replace(new RegExp("\\\\","g"),""),n.type="closed"):"name"==r&&(n.tag=o[l].value);o=t(':input[name^="'+piklist.prefix+'shortcode["]').serializeArray();for(l=0;l<o.length;l++)s=(piklist.prefix+"shortcode").length+1,"id"!=(r=o[l].name.substr(s,o[l].name.indexOf("]")-s)).toLowerCase()&&(p+=r+'="'+encodeURIComponent(o[l].value)+'" ');n.attrs=wp.shortcode.attrs(p),void 0===piklist.shortcodes[n.tag]||"closed"!=piklist.shortcodes[n.tag].type&&"single"!=piklist.shortcodes[n.tag].type||(n.type=piklist.shortcodes[n.tag].type),d=wp.shortcode.string(n);var c=t(e).triggerHandler("piklist:shortcode:insert",[d,n]);void 0!==c&&(d=c),parent.send_to_editor(d),parent.switchEditors.go(parent.tinymce.activeEditor.id,"html"),parent.switchEditors.go(parent.tinymce.activeEditor.id,"tmce"),parent.tb_remove()}else t("ul.piklist-shortcodes > .attachment").on("click",function(e){t('input[name="'+piklist.prefix+'shortcode_data[name]"]').val(t(this).data("piklist-shortcode"));var s=t(':input[name^="'+piklist.prefix+'shortcode_data["]').serializeArray(),a="undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1?"&"+piklist.prefix+"post[ID]="+t("#post_ID").val():null,o={};t.each(s,function(t,i){o[i.name]=i.value}),i.location.href=i.location.href+(i.location.href.indexOf("?")>-1?"&":"?")+t.param(o)+(a||"")})},shortcode:function(e){return{template:wp.media.template("piklist-shortcode"),getContent:function(){if(!0===piklist.shortcodes[this.shortcode.tag].preview){var e="undefined"!=typeof tinymce&&tinymce.Env.ie,s=t("<iframe/>"),a="piklist-shortcode-preview-"+this.shortcode.tag+"-"+Math.random().toString(36).substr(2,16);return s.attr("id",a).attr("src",e?'javascript:""':"").attr("frameBorder","0").attr("allowTransparency","true").attr("scrolling","no").addClass("piklist-shortcode-preview").css({width:"100%",height:"1",display:"block"}),t.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"piklist_shortcode",shortcode:wp.shortcode.string(this.shortcode),post_id:t("#post_ID").val(),preview_id:a},success:function(e){t(".wp-editor-wrap iframe").each(function(){var s=t(this).contents().find("iframe#"+e.data.preview_id);if(s.length>0){var a=i.MutationObserver||i.WebKitMutationObserver||i.MozMutationObserver,o=s.contents().find("head"),n=s.contents().find("body"),r=function(){try{s.height(s.contents().find("html").outerHeight())}catch(t){}};if(t(this).contents().find("head").find("link").each(function(){o.append(t(this).prop("outerHTML"))}),n.css("min-height","100%").html(e.data.html).find("a").attr("target","_blank"),a){new a(function(){s.contents().find("img, link").load(r),r()}).observe(s.contents().find("body")[0],{attributes:!0,childList:!0,subtree:!0})}else for(var p=1;p<6;p++)setTimeout(r,700*p);setTimeout(r,700)}})}}),s.prop("outerHTML")}if(!0===piklist.shortcodes[this.shortcode.tag].inline){s=[];if(this.template=wp.media.template("piklist-shortcode-inline"),""!=this.shortcode.content)s.push(this.shortcode.content);else for(var o in this.shortcode.attrs.named)s.push(this.shortcode.attrs.named[o]+" ("+o+")");return this.template({tag:this.shortcode.tag,attributes:this.shortcode.attrs.named,preview:s,options:void 0!==piklist.shortcodes[this.shortcode.tag]?piklist.shortcodes[this.shortcode.tag]:{name:this.shortcode.tag.replace(/_/g," ").toUpperCase()}})}return this.template({tag:this.shortcode.tag,attributes:this.shortcode.attrs.named,options:void 0!==piklist.shortcodes[this.shortcode.tag]?piklist.shortcodes[this.shortcode.tag]:{name:this.shortcode.tag.replace(/_/g," ").toUpperCase()}})},replaceMarkers:function(){this.getMarkers(function(i,e){var s,a=e===i.selection.getNode();if(this.loader||t(e).text()===this.text){if(!0===piklist.shortcodes[this.type].inline){var o=t(e).prev(),n=t(e).next(),r=void 0!==o&&void 0!==o.html()?o.html():"",p=void 0!==n&&void 0!==n.html()?n.html():"",d=void 0!==o?o.prop("tagName"):n.prop("tagName");d=d||"p",s=i.$("<"+d+">"+r+(""!=r&&"&nbsp;"!=r.substr(r.length-6)?"&nbsp;":"")+'<span class="wpview wpview-wrap wpview-wrap-inline" data-wpview-text="'+this.encodedText+'" data-wpview-type="'+this.type+'" contenteditable="false"><span class="wpview-body"><span class="wpview-content wpview-type-'+this.type+'"></span></span></span>'+(""!=p&&"&nbsp;"!=p.substr(0,6)?"&nbsp;":"")+p+"</"+d+">"),i.$(o).remove(),i.$(n).remove(),i.$(e).replaceWith(s)}else s=i.$('<div class="wpview wpview-wrap" data-wpview-text="'+this.encodedText+'" data-wpview-type="'+this.type+'" contenteditable="false"><p class="wpview-selection-before"> </p><div class="wpview-body"><div class="wpview-content wpview-type-'+this.type+'"></div></div><p class="wpview-selection-after"> </p></div>'),i.$(e).replaceWith(s);a&&void 0!==i.wp&&void 0!==i.wp.setViewCursor&&i.wp.setViewCursor(!1,s[0])}else i.dom.setAttrib(e,"data-wpview-marker",null)})},edit:function(e){"object"==typeof e&&(e=decodeURIComponent(t(e).data("wpview-text")));var s={},a=wp.shortcode.regexp(this.type);a.lastIndex=0;var o=a.exec(e);if(o){s={attrs:wp.shortcode.attrs(o[3]),tag:this.type,content:o[5],type:void 0!==o[6]?"closed":"single"};var n=void 0!==i.tinymce.activeEditor&&i.tinymce.activeEditor,r=t(n.getDoc()),p=location.href.substr(0,location.href.indexOf("/wp-"))+"/wp-admin/admin.php",d=t(r.find('*[data-wpview-type="'+this.type+'"]')).index(r.find('*[data-wpview-type="'+this.type+'"][data-mce-selected="1"]')),l={page:"shortcode_editor"};"undefined"!=typeof pagenow&&t.inArray(pagenow,["post","post-new"])>-1&&(l[piklist.prefix+"post[ID]"]=t("#post_ID").val()),l[piklist.prefix+"[admin_hide_ui]"]="true",t.each(s.attrs.named,function(t,i){l[piklist.prefix+"shortcode["+t+"]"]=i}),l[piklist.prefix+"shortcode_data[name]"]=s.tag,l[piklist.prefix+"shortcode_data[action]"]="update",l[piklist.prefix+"shortcode_data[index]"]=!(d<0)&&d,void 0!==s.content&&(l[piklist.prefix+"shortcode_data[content]"]=switchEditors._wp_Nop(s.content)),l.TB_iframe="true";for(var c in l)"string"==t.type(l[c])&&(l[c]=l[c].replace(/\\\'/g,"'"),l[c]=escape(l[c]));tb_show("Edit "+(piklist.shortcodes[this.type].name?piklist.shortcodes[this.type].name:null),p+"?"+t.param(l)),t(i).trigger("resize")}},indexesOf:function(t,i){var e,s=[];for(i=new RegExp(i);e=i.exec(t);)s.push(e.index);return s}}},customizer:function(){t("body").hasClass("wp-customizer")&&(t(".widget-tpl").on("click",function(){setTimeout(a.customizer_widget_setup,100)}),setTimeout(a.customizer_widget_setup,100),t(e).on("widget-synced",function(t,i,e){if(i.parent().attr("id").indexOf("customize-control-widget"+piklist.prefix+"piklist-universal-widget")>-1){var s=i.find(".widget-content:first");i.find(".widget-inside:first").css("top",0),s.css({visibility:"hidden","max-height":"100%"}).html(e),s.removeData("wptabs").removeData("piklistgroups").removeData("piklistcolumns").removeData("piklistmediaupload").removeData("piklistaddmore").removeData("piklistfields"),setTimeout(function(){s.find(".piklist-universal-widget-form-container").wptabs().piklistgroups().piklistcolumns().piklistmediaupload().piklistaddmore({sortable:!0}).piklistfields(),s.css({visibility:"visible",overflow:"visible"})},50)}}))},customizer_widget_setup:function(){t(".piklist-universal-widget-select").each(function(){t(this).parents(".widget-content:eq(0)").off("change input propertychange")})},widgets:function(){t(e).on("mousedown",'.widget input[name="savewidget"]',function(){var i=t(this),e=i.parents(".widget-control-actions:first").siblings(".widget-content:first"),s=i.parents(".widget").find(".widget-title h4"),a=i.parents("form").find(".piklist-universal-widget-form-container").data("widget-title");t(".piklist-universal-widget-form-container").on("remove",function(){e.css({height:e.outerHeight(),overflow:"hidden"}),e.removeData("wptabs").removeData("piklistgroups").removeData("piklistcolumns").removeData("piklistmediaupload").removeData("piklistaddmore").removeData("piklistfields"),setTimeout(function(){e.find(".piklist-universal-widget-form-container").wptabs().piklistgroups().piklistcolumns().piklistmediaupload().piklistaddmore({sortable:!0}).piklistfields(),void 0!==a&&s.find(".in-widget-title").text(":  "+a),e.css({height:"auto",overflow:"visible"})},50)}),"undefined"!=typeof tinyMCE&&(tinyMCE.triggerSave(),e.find(".wp-editor-area").each(function(){"undefined"!=typeof switchEditors&&switchEditors.go(t(this).attr("id"),"tmce")}))}),a.widget_title(),t(e).on("change",".piklist-universal-widget-select",function(i){var e=t(this).val(),s=("piklist-universal-widget-"+t(this).data("piklist-addon")).replace(/-/g,"_"),o=t(this).parents(".widget-content"),n=(t(this).attr("class").split(" "),o.find(".piklist-universal-widget-form-container")),r=t(this).attr("name").split("[")[1].replace(/\]/g,""),p=t(this).parents(".widget").find(".widget-title h4"),d=o.find(".piklist-universal-widget-select-container p"),l=o.data("piklist-wptab-active");e&&(n.hide().empty(),t.ajax({type:"POST",url:ajaxurl,async:!1,dataType:"json",data:{action:s,widget:e,number:r},success:function(t){p.find(".in-widget-title").text(":  "+t.widget.data.title),d.text(t.widget.data.description),n.removeData("wptabs").removeData("piklistgroups").removeData("piklistcolumns").removeData("piklistmediaupload").removeData("piklistaddmore").removeData("piklistfields"),n.html(t.form).wptabs().piklistgroups().piklistcolumns().piklistmediaupload().piklistaddmore({sortable:!0}).piklistfields(),o.find(".wp-tab-bar > li").removeClass("wp-tab-active"),o.find(".wp-tab-bar > li:first").addClass("wp-tab-active"),o.find(".wp-tab-bar").length>0&&void 0!==l&&o.find(".wp-tab-bar > li").removeClass("wp-tab-active").get(2).addClass("wp-tab-active"),a.widget_dimensions(o,t.widget.data.height,t.widget.data.width)}}))}),t(".wp-tab-bar li a").on("click",function(i){var e=t(this).parents(".widget-content:first");e.length>0&&e.attr("data-piklist-wptab-active",t(this).text())}),a.widget_title()},widget_title:function(){setTimeout(function(){t(".piklist-universal-widget-form-container").each(function(){var i=t(this).parents(".widget-content"),e=t(this).parents(".widget").find(".widget-title h4"),s=t(this).data("widget-title"),o=t(this).data("widget-height"),n=t(this).data("widget-width");void 0!==s&&e.find(".in-widget-title").text(":  "+s),a.widget_dimensions(i,o,n)})},250)},widget_dimensions:function(i,e,s){var a=i.parents(".widget:first"),o=a.find(".widget-inside"),n=a.find(".widget-action:first"),r=!1;o.is(":visible")&&(n.trigger("click"),r=!0),i.siblings('input[name="widget-width"]').val(s||250),i.siblings('input[name="widget-height"]').val(e||200),t("body.wp-customizer").length>0&&o.find(".widget-content").css({width:s,"max-width":s}).attr("style","max-width: "+s+" !important"),setTimeout(function(){i.find(".piklist-universal-widget-form-container").show(),r&&n.trigger("click")},250)},list_tables:function(){t(".piklist-list-table-export-columns").sortable().disableSelection(),t(".piklist-list-table-export-submit").on("click",function(i){var e=t(this).attr("rel");tb_remove(),t("#"+e).submit()})}};t(e).on("sortstart",".ui-sortable",function(i,e){t(this).is(".ui-sortable")&&"undefined"!=typeof tinyMCE&&t(this).find(".wp-editor-area.piklist-field-element").each(function(){var i=t(this).attr("id"),e=3==tinymce.majorVersion?"mceRemoveControl":"mceRemoveEditor";tinyMCE.execCommand(e,!1,i)})}).on("sortstop sortreceive",".ui-sortable",function(i,e){t(this).is(".ui-sortable")&&"undefined"!=typeof tinyMCE&&t(this).find(".wp-editor-area.piklist-field-element").each(function(){var i=t(this).attr("id"),e=3==tinymce.majorVersion?"mceAddControl":"mceAddEditor";tinyMCE.execCommand(e,!1,i)})});var o=function(i,e){this.$element=t(i),this._init()};o.prototype={constructor:o,_init:function(){this.setup(),t(".wp-tab-bar li a").on("click",function(i){i.preventDefault();var e=t(this).closest("li"),s=t(this).closest(".wp-tab-bar").children().index(e),a=t(this).closest(".wp-tab-bar").nextUntil(".wp-tab-bar",".wp-tab-panel");e.addClass("wp-tab-active").siblings().removeClass("wp-tab-active");for(var o=0;o<a.length;o++)t(a[o]).toggle(o==s)})},setup:function(){t(".wp-tab-bar li a").each(function(){var i=t(this).closest("li");if(!i.hasClass("wp-tab-active")){var e=t(this).closest(".wp-tab-bar").children().index(i);t(this).closest(".wp-tab-bar").nextUntil(".wp-tab-bar",".wp-tab-panel").eq(e).hide()}})}},t.fn.wptabs=function(i){var e=Array.apply(null,arguments);return e.shift(),this.each(function(){var s=t(this),a=s.data("wptabs"),n="object"==typeof i&&i;a||s.data("wptabs",a=new o(this,t.extend({},t.fn.wptabs.defaults,n,t(this).data()))),"string"==typeof i&&a[i].apply(a,e)})},t.fn.wptabs.defaults={},t.fn.wptabs.Constructor=o}(jQuery,window,document);