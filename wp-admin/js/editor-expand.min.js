!function(t,e,o){"use strict";var i=e(t),n=e(document),s=e("#wpadminbar"),f=e("#wpfooter");e(function(){function o(){var t=x.value.length;l&&!l.isHidden()||(l||"tinymce"!==I)&&(t<y?V():parseInt(x.style.height,10)<x.scrollHeight&&(x.style.height=Math.ceil(x.scrollHeight)+"px",a()),y=t)}function a(e){if(!E||!E.settings.visible){var a,d,c,u,r,p,g,x,y=i.scrollTop(),_=e&&e.type,k="scroll"!==_,A=l&&!l.isHidden(),D=F,I=z.offset().top,V=h.width();!k&&M.windowHeight||function(){var t=i.width();(M={windowHeight:i.height(),windowWidth:t,adminBarHeight:t>600?s.outerHeight():0,toolsHeight:m.outerHeight()||0,menuBarHeight:B.outerHeight()||0,visualTopHeight:w.outerHeight()||0,textTopHeight:b.outerHeight()||0,bottomHeight:T.outerHeight()||0,statusBarHeight:C.outerHeight()||0,sideSortablesHeight:S.height()||0}).menuBarHeight<3&&(M.menuBarHeight=0)}(),A||"resize"!==_||o(),A?(a=w,d=H,p=M.visualTopHeight):(a=b,d=v,p=M.textTopHeight),(A||a.length)&&(r=a.parent().offset().top,g=d.offset().top,(x=d.outerHeight())>(A?F+p:F+20)+5?((!W||k)&&y>=r-M.toolsHeight-M.adminBarHeight&&y<=r-M.toolsHeight-M.adminBarHeight+x-D?(W=!0,m.css({position:"fixed",top:M.adminBarHeight,width:V}),A&&B.length&&B.css({position:"fixed",top:M.adminBarHeight+M.toolsHeight,width:V-2-(A?0:a.outerWidth()-a.width())}),a.css({position:"fixed",top:M.adminBarHeight+M.toolsHeight+M.menuBarHeight,width:V-2-(A?0:a.outerWidth()-a.width())})):(W||k)&&(y<=r-M.toolsHeight-M.adminBarHeight?(W=!1,m.css({position:"absolute",top:0,width:V}),A&&B.length&&B.css({position:"absolute",top:0,width:V-2}),a.css({position:"absolute",top:M.menuBarHeight,width:V-2-(A?0:a.outerWidth()-a.width())})):y>=r-M.toolsHeight-M.adminBarHeight+x-D&&(W=!1,m.css({position:"absolute",top:x-D,width:V}),A&&B.length&&B.css({position:"absolute",top:x-D,width:V-2}),a.css({position:"absolute",top:x-D+M.menuBarHeight,width:V-2-(A?0:a.outerWidth()-a.width())}))),(!K||k&&L)&&y+M.windowHeight<=g+x+M.bottomHeight+M.statusBarHeight+1?e&&e.deltaHeight>0&&e.deltaHeight<100?t.scrollBy(0,e.deltaHeight):A&&L&&(K=!0,C.css({position:"fixed",bottom:M.bottomHeight,visibility:"",width:V-2}),T.css({position:"fixed",bottom:0,width:V})):(!L&&K||(K||k)&&y+M.windowHeight>g+x+M.bottomHeight+M.statusBarHeight-1)&&(K=!1,C.attr("style",L?"":"visibility: hidden;"),T.attr("style",""))):k&&(m.css({position:"absolute",top:0,width:V}),A&&B.length&&B.css({position:"absolute",top:0,width:V-2}),a.css({position:"absolute",top:M.menuBarHeight,width:V-2-(A?0:a.outerWidth()-a.width())}),C.attr("style",L?"":"visibility: hidden;"),T.attr("style","")),O.width()<300&&M.windowWidth>600&&n.height()>S.height()+I+120&&M.windowHeight<x?(M.sideSortablesHeight+P+X>M.windowHeight||R||Y?y+P<=I?(S.attr("style",""),R=Y=!1):y>U?R?(R=!1,c=S.offset().top-M.adminBarHeight,(u=f.offset().top)<c+M.sideSortablesHeight+X&&(c=u-M.sideSortablesHeight-12),S.css({position:"absolute",top:c,bottom:""})):!Y&&M.sideSortablesHeight+S.offset().top+X<y+M.windowHeight&&(Y=!0,S.css({position:"fixed",top:"auto",bottom:X})):y<U&&(Y?(Y=!1,c=S.offset().top-X,(u=f.offset().top)<c+M.sideSortablesHeight+X&&(c=u-M.sideSortablesHeight-12),S.css({position:"absolute",top:c,bottom:""})):!R&&S.offset().top>=y+P&&(R=!0,S.css({position:"fixed",top:P,bottom:""}))):(y>=I-P?S.css({position:"fixed",top:P}):S.attr("style",""),R=Y=!1),U=y):(S.attr("style",""),R=Y=!1),k&&(h.css({paddingTop:M.toolsHeight}),A?H.css({paddingTop:M.visualTopHeight+M.menuBarHeight}):v.css({marginTop:M.textTopHeight})))}}function d(){o(),a()}function c(t){for(var e=1;e<6;e++)setTimeout(t,500*e)}function u(){t.pageYOffset&&t.pageYOffset>D&&t.scrollTo(t.pageXOffset,0),g.addClass("wp-editor-expand"),i.on("scroll.editor-expand resize.editor-expand",function(t){a(t.type),clearTimeout(p),p=setTimeout(a,100)}),n.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",a).on("postbox-toggled.editor-expand postbox-moved.editor-expand",function(){!R&&!Y&&t.pageYOffset>P&&(Y=!0,t.scrollBy(0,-1),a(),t.scrollBy(0,1)),a()}).on("wp-window-resized.editor-expand",function(){l&&!l.isHidden()?l.execCommand("wpAutoResize"):o()}),v.on("focus.editor-expand input.editor-expand propertychange.editor-expand",o),k(),E&&E.pubsub.subscribe("hidden",d),l&&(l.settings.wp_autoresize_on=!0,l.execCommand("wpAutoResizeOn"),l.isHidden()||l.execCommand("wpAutoResize")),l&&!l.isHidden()||o(),a(),n.trigger("editor-expand-on")}function r(){var o=parseInt(t.getUserSetting("ed_size",300),10);o<50?o=50:o>5e3&&(o=5e3),t.pageYOffset&&t.pageYOffset>D&&t.scrollTo(t.pageXOffset,0),g.removeClass("wp-editor-expand"),i.off(".editor-expand"),n.off(".editor-expand"),v.off(".editor-expand"),A(),E&&E.pubsub.unsubscribe("hidden",d),e.each([w,b,m,B,T,C,h,H,v,S],function(t,e){e&&e.attr("style","")}),W=K=R=Y=!1,l&&(l.settings.wp_autoresize_on=!1,l.execCommand("wpAutoResizeOff"),l.isHidden()||(v.hide(),o&&l.theme.resizeTo(null,o))),o&&v.height(o),n.trigger("editor-expand-off")}var l,p,g=e("#postdivrich"),h=e("#wp-content-wrap"),m=e("#wp-content-editor-tools"),w=e(),H=e(),b=e("#ed_toolbar"),v=e("#content"),x=v[0],y=0,T=e("#post-status-info"),B=e(),C=e(),S=e("#side-sortables"),O=e("#postbox-container-1"),z=e("#post-body"),E=t.wp.editor&&t.wp.editor.fullscreen,k=function(){},A=function(){},W=!1,K=!1,R=!1,Y=!1,U=0,D=130,P=56,X=20,F=300,I=h.hasClass("tmce-active")?"tinymce":"html",L=!!parseInt(t.getUserSetting("hidetb"),10),M={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0},V=t._.throttle(function(){var e=t.scrollX||document.documentElement.scrollLeft,o=t.scrollY||document.documentElement.scrollTop,i=parseInt(x.style.height,10);x.style.height=F+"px",x.scrollHeight>F&&(x.style.height=x.scrollHeight+"px"),void 0!==e&&t.scrollTo(e,o),x.scrollHeight<i&&a()},300);n.on("tinymce-editor-init.editor-expand",function(n,s){function f(t){var e=t.keyCode;e<=47&&e!==b.SPACEBAR&&e!==b.ENTER&&e!==b.DELETE&&e!==b.BACKSPACE&&e!==b.UP&&e!==b.LEFT&&e!==b.DOWN&&e!==b.UP||e>=91&&e<=93||e>=112&&e<=123||144===e||145===e||d(e)}function d(e){var o,i,n,f,a=function(){var t,e,o,i=s.selection.getNode();if(s.wp&&s.wp.getView&&(e=s.wp.getView(i)))o=e.getBoundingClientRect();else{t=s.selection.getRng();try{o=t.getClientRects()[0]}catch(t){}o||(o=i.getBoundingClientRect())}return!!o.height&&o}();a&&(i=(o=a.top+s.iframeElement.getBoundingClientRect().top)+a.height,o-=50,i+=50,n=M.adminBarHeight+M.toolsHeight+M.menuBarHeight+M.visualTopHeight,(f=M.windowHeight-(L?M.bottomHeight+M.statusBarHeight:0))-n<a.height||(o<n&&(e===b.UP||e===b.LEFT||e===b.BACKSPACE)?t.scrollTo(t.pageXOffset,o+t.pageYOffset-n):i>f&&t.scrollTo(t.pageXOffset,i+t.pageYOffset-f)))}function u(t){t.state||a()}function r(){i.on("scroll.mce-float-panels",v),setTimeout(function(){s.execCommand("wpAutoResize"),a()},300)}function p(){i.off("scroll.mce-float-panels"),setTimeout(function(){var e=h.offset().top;t.pageYOffset>e&&t.scrollTo(t.pageXOffset,e-M.adminBarHeight),o(),a()},100),a()}function m(){L=!L}var b=t.tinymce.util.VK,v=_.debounce(function(){!e(".mce-floatpanel:hover").length&&t.tinymce.ui.FloatPanel.hideAll(),e(".mce-tooltip").hide()},1e3,!0);"content"===s.id&&(l=s,s.settings.autoresize_min_height=F,w=h.find(".mce-toolbar-grp"),H=h.find(".mce-edit-area"),C=h.find(".mce-statusbar"),B=h.find(".mce-menubar"),k=function(){s.on("keyup",f),s.on("show",r),s.on("hide",p),s.on("wp-toolbar-toggle",m),s.on("setcontent wp-autoresize wp-toolbar-toggle",a),s.on("undo redo",d),s.on("FullscreenStateChanged",u),i.off("scroll.mce-float-panels").on("scroll.mce-float-panels",v)},A=function(){s.off("keyup",f),s.off("show",r),s.off("hide",p),s.off("wp-toolbar-toggle",m),s.off("setcontent wp-autoresize wp-toolbar-toggle",a),s.off("undo redo",d),s.off("FullscreenStateChanged",u),i.off("scroll.mce-float-panels")},g.hasClass("wp-editor-expand")&&(k(),c(a)))}),g.hasClass("wp-editor-expand")&&(u(),h.hasClass("html-active")&&c(function(){a(),o()})),e("#adv-settings .editor-expand").show(),e("#editor-expand-toggle").on("change.editor-expand",function(){e(this).prop("checked")?(u(),t.setUserSetting("editor_expand","on")):(r(),t.setUserSetting("editor_expand","off"))}),t.editorExpand={on:u,off:r}}),e(function(){function o(){(x=k.offset()).right=x.left+k.outerWidth(),x.bottom=x.top+k.outerHeight()}function a(){X||(X=!0,n.trigger("dfw-activate"),W.on("keydown.focus-shortcut",w))}function d(){X&&(u(),X=!1,n.trigger("dfw-deactivate"),W.off("keydown.focus-shortcut"))}function c(){!F&&X&&(F=!0,W.on("keydown.focus",l),A.add(W).on("blur.focus",g),l(),t.setUserSetting("post_dfw","on"),n.trigger("dfw-on"))}function u(){F&&(F=!1,A.add(W).off(".focus"),p(),k.off(".focus"),t.setUserSetting("post_dfw","off"),n.trigger("dfw-off"))}function r(){F?u():c()}function l(e){var n,f=e&&e.keyCode;t.navigator.platform&&(n=t.navigator.platform.indexOf("Mac")>-1),27===f||87===f&&e.altKey&&(!n&&e.shiftKey||n&&e.ctrlKey)?p(e):e&&(e.metaKey||e.ctrlKey&&!e.altKey||e.altKey&&e.shiftKey||f&&(f<=47&&8!==f&&13!==f&&32!==f&&46!==f||f>=91&&f<=93||f>=112&&f<=135||f>=144&&f<=150||f>=224))||(H||(H=!0,clearTimeout(O),O=setTimeout(function(){K.show()},600),k.css("z-index",9998),K.on("mouseenter.focus",function(){o(),i.on("scroll.focus",function(){var e=t.pageYOffset;C&&B&&C!==e&&(B<x.top-M||B>x.bottom+M)&&p(),C=e})}).on("mouseleave.focus",function(){y=T=null,I=L=0,i.off("scroll.focus")}).on("mousemove.focus",function(e){var o=e.clientX,i=e.clientY,n=t.pageYOffset,s=t.pageXOffset;if(y&&T&&(o!==y||i!==T))if(i<=T&&i<x.top-n||i>=T&&i>x.bottom-n||o<=y&&o<x.left-s||o>=y&&o>x.right-s){if(I+=Math.abs(y-o),L+=Math.abs(T-i),(i<=x.top-M-n||i>=x.bottom+M-n||o<=x.left-M-s||o>=x.right+M-s)&&(I>10||L>10))return p(),y=T=null,void(I=L=0)}else I=L=0;y=o,T=i}).on("touchstart.focus",function(t){t.preventDefault(),p()}),k.off("mouseenter.focus"),S&&(clearTimeout(S),S=null),E.addClass("focus-on").removeClass("focus-off")),!b&&H&&(b=!0,s.on("mouseenter.focus",function(){s.addClass("focus-off")}).on("mouseleave.focus",function(){s.removeClass("focus-off")})),h())}function p(t){H&&(H=!1,clearTimeout(O),O=setTimeout(function(){K.hide()},200),k.css("z-index",""),K.off("mouseenter.focus mouseleave.focus mousemove.focus touchstart.focus"),void 0===t&&k.on("mouseenter.focus",function(){(e.contains(k.get(0),document.activeElement)||z)&&l()}),S=setTimeout(function(){S=null,k.off("mouseenter.focus")},1e3),E.addClass("focus-off").removeClass("focus-on")),b&&(b=!1,s.off(".focus")),m()}function g(){setTimeout(function(){function t(t){return e.contains(t.get(0),document.activeElement)}var o=document.activeElement.compareDocumentPosition(k.get(0));2!==o&&4!==o||!(t(U)||t(_)||t(f))||p()},0)}function h(){v||!H||R.find(":focus").length||(v=!0,R.stop().fadeTo("fast",.3).on("mouseenter.focus",m).off("mouseleave.focus"),Y.on("focus.focus",m).off("blur.focus"))}function m(){v&&(v=!1,R.stop().fadeTo("fast",1).on("mouseleave.focus",h).off("mouseenter.focus"),Y.on("blur.focus",h).off("focus.focus"))}function w(t){t.altKey&&t.shiftKey&&87===t.keyCode&&r()}var H,b,v,x,y,T,B,C,S,O,z,E=e(document.body),_=e("#wpcontent"),k=e("#post-body-content"),A=e("#title"),W=e("#content"),K=e(document.createElement("DIV")),R=e("#edit-slug-box"),Y=R.find("a").add(R.find("button")).add(R.find("input")),U=e("#adminmenuwrap"),D=e(),P=e(),X="on"===t.getUserSetting("editor_expand","on"),F=!!X&&"on"===t.getUserSetting("post_dfw"),I=0,L=0,M=20;E.append(K),K.css({display:"none",position:"fixed",top:s.height(),right:0,bottom:0,left:0,"z-index":9997}),k.css({position:"relative"}),i.on("mousemove.focus",function(t){B=t.pageY}),e("#postdivrich").hasClass("wp-editor-expand")&&W.on("keydown.focus-shortcut",w),n.on("tinymce-editor-setup.focus",function(t,e){e.addButton("dfw",{active:F,classes:"wp-dfw btn widget",disabled:!X,onclick:r,onPostRender:function(){var t=this;n.on("dfw-activate.focus",function(){t.disabled(!1)}).on("dfw-deactivate.focus",function(){t.disabled(!0)}).on("dfw-on.focus",function(){t.active(!0)}).on("dfw-off.focus",function(){t.active(!1)})},tooltip:"Distraction-free writing mode",shortcut:"Alt+Shift+W"}),e.addCommand("wpToggleDFW",r),e.addShortcut("access+w","","wpToggleDFW")}),n.on("tinymce-editor-init.focus",function(t,i){function s(){z=!0}function f(){z=!1}var a,d;"content"===i.id&&(D=e(i.getWin()),P=e(i.getContentAreaContainer()).find("iframe"),a=function(){i.on("keydown",l),i.on("blur",g),i.on("focus",s),i.on("blur",f),i.on("wp-autoresize",o)},d=function(){i.off("keydown",l),i.off("blur",g),i.off("focus",s),i.off("blur",f),i.off("wp-autoresize",o)},F&&a(),n.on("dfw-on.focus",a).on("dfw-off.focus",d),i.on("click",function(t){t.target===i.getDoc().documentElement&&i.focus()}))}),n.on("quicktags-init",function(t,o){var i;o.settings.buttons&&-1!==(","+o.settings.buttons+",").indexOf(",dfw,")&&(i=e("#"+o.name+"_dfw"),e(document).on("dfw-activate",function(){i.prop("disabled",!1)}).on("dfw-deactivate",function(){i.prop("disabled",!0)}).on("dfw-on",function(){i.addClass("active")}).on("dfw-off",function(){i.removeClass("active")}))}),n.on("editor-expand-on.focus",a).on("editor-expand-off.focus",d),F&&(W.on("keydown.focus",l),A.add(W).on("blur.focus",g)),t.wp=t.wp||{},t.wp.editor=t.wp.editor||{},t.wp.editor.dfw={activate:a,deactivate:d,isActive:function(){return X},on:c,off:u,toggle:r,isOn:function(){return F}}})}(window,window.jQuery);